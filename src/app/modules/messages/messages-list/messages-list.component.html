<div nz-col class="messages-list-wrapper">
  <div class="search mb-vertical-align">
    <nz-input-group [nzSuffix]="suffixIconSearch">
      <input type="text" nz-input placeholder="input search text" (change)="search($event.target.value)" />
    </nz-input-group>
    <ng-template #suffixIconSearch>
      <i nz-icon type="search"></i>
    </ng-template>
  </div>

  <nz-list [nzLoadMore]="loadMore" class="messages-list" [nzLoading]="loading">
    <ng-container *ngTemplateOutlet="emptyTemplate"></ng-container>
    <nz-list-item [routerLink]="['/', 'messages', 'c', conversation.id]" routerLinkActive="active"
      class="messages-list-item" [class.new]="!isRead(conversation)" *ngFor="let conversation of conversations?.results">
      <nz-skeleton *ngIf="false" [nzAvatar]="true" [nzParagraph]="{ rows: 1 }"></nz-skeleton>
      <nz-list-item-meta *ngIf="true" [nzTitle]="titleTemplate" [nzAvatar]="avatarTemplate"
        [nzDescription]="descriptionTemplate">
        <ng-template #titleTemplate>
          <a [routerLink]="['/', 'messages', 'c', conversation.id]">
            {{conversation.users[0].first_name ? conversation.users[0]?.first_name + ' ' + conversation.users[0]?.last_name : "Noname"}}
            <i *ngIf="!isRead(conversation)" nz-icon [nzType]="'info-circle'" [nzTheme]="'fill'" style="color: #6772e5"></i>
          </a>
        </ng-template>
        <ng-template #avatarTemplate>
          <nz-avatar [nzSize]="50" nzIcon="user" [nzSrc]="conversation.users[0]?.image || 'assets/images/undraw_user.svg'"></nz-avatar>
        </ng-template>
        <ng-template #descriptionTemplate>
          <span>{{chatService.badges[conversation.id]?.lastMsg || conversation.last_msg}}</span>
        </ng-template>
      </nz-list-item-meta>
    </nz-list-item>

    <ng-template #loadMore>
      <div class="loadmore" *ngIf="conversations?.next">
        <a (click)="loadMoreConversations()" i18n="@@loadMoreText">Load more</a>
      </div>
    </ng-template>
  </nz-list>
</div>

<ng-template #emptyTemplate>
  <nz-empty *ngIf="!conversations || !conversations.results || conversations.results.length == 0"
    [nzNotFoundContent]="contentTpl">
    <ng-template #contentTpl>
      <span i18n="Text to tell user that there are no msgs in selected conversation@@noMessagesInConversationText"> No messages </span>
    </ng-template>
  </nz-empty>
</ng-template>
